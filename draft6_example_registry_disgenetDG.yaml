## example of using the x-bte-association-retrieval schema 
##   to write a registry entry for querying MyDisease.info API
##   diseases -> genes (which uses disgenet)
## notes about this specific registry entry: 
## - none of the operations have restrictions (context/relevance)
## - some API/JSON-response fields weren't used (YearInitial, YearFinal for
##   the years first and last reported)
## - MyDisease.info is a complex API with a lot of operations/sources that
##   aren't included here

## notes for developers:
##  - this registry file is related to other files: provenance-mapping file,
##    BTE code, and an example of a processed association. 
##  - in the future? have a script alerting developer of DisGeNET update.
##    Workflow: review the new DisGeNET data, change the parser if needed,
##    update the metadata files if needed 
## this is 79 char long #######################################################

components:      
  ## operations to query KPs for associations go under this x-bte extension
  x-bte-association-retrieval:  
  ## each object below describes one operation 
    disease-gene1:  ## name for this particular operation
    ## raw API/JSON-response example used to help write this:
    ## http://mydisease.info/v1/disease/MONDO:0016419?fields=disgenet.genes_related_to_disease
      queryInfo:  ## required
        supportBatch: true
        inputSeparator: ","
        parameters:
          fields: "disgenet.genes_related_to_disease"
        requestBody:
          body:     
            q: "{inputs[0]}"
            scopes: "mondo.xrefs.umls, disgenet.xrefs.umls"
          header: "application/x-www-form-urlencoded"
      inputs:  ## required
      - id: UMLS
        semantic: Disease
        ## ?? need to check pre-processing code to check if this is right
        requiresPrefix: false
      outputs:   ## required
      - id: NCBIGene
        semantic: Gene  
        containsPrefix: false
        responseField: "disgenet.gene_related_to_disease.gene_id"
      ## WHAT the relationship is
      predicateInfo:  
      ## biolink / id / label use staticValue sub-schema to set these values
      ##   in the registry
        biolink:  ## similar to TRAPI/biolink predicate field
          value: "related_to"  ## ?? 'biolink:' prefix 
        id:  ## similar to TRAPI/biolink relation field
          value: "SIO:001403" 
        label: 
          value: "SIO:is_associated_with"
        nodesConflated:  ## optional 
        ## DisGeNET disease-gene relationships appear to conflate the biolink entity classes 
        - original: Disease
          conflated: PhenotypicFeature
          where: DisGeNET
        - original: Gene
          conflated: GeneProduct
          where: DisGeNET   
      references:  ## optional, include when possible
        publications:
        ## the supporting publications are PMIDs (no prefixes) stored as 
        ##   an array of ints in the pubmed field of the API/JSON-response
        ## uses the takesOnResponseValue sub-schema since that format is fine
        ##   for the final values (see the processed association schema)
          pmid: 
            responseField: "disgenet.genes_related_to_disease.pubmed"
        websites:    ## uses the transformUsingTemplate sub-schema
          instructions: >-
            Create an array of one or more strings using the template. There
            should be a separate URL for each disease ID. Each association
            should have one source and one gene ID. Result should be a key
            (websites) with a value (the array of string website URLs)
          ## this should be parsed as one string with no spaces
          template:
            "https://www.disgenet.org/browser/0/1/1/{disease}/\
            geneid__{gene}-source__{source}/"
          templateKeys:  ## keywords in template
            source: "disgenet.genes_related_to_disease.source"
            gene: "disgenet.genes_related_to_disease.gene_id"
            disease: "inputs[0]"
            ## the UMLS Disease IDs (no prefix), used as input to the query
            ## should be an array of one or more strings 
          bteCode: ""  
          ## github link to the code that uses this info to process response
      provenance:  ## uses the transformResponseValues sub-schema
        instructions: >- 
          Map from a specific association/JSON-record and its value in the
          source field to an array of objects describing the sources (standard
          provenance model). This mapping is stored in the mappingFile YAML
          within the provenanceMapping object. Result should be a key
          (provenance) with a value (the array of objects describing the
          sources)
        responseFieldsUsed: "disgenet.genes_related_to_disease.source"
        mappingFile: "draft6_example_mappingFile_disgenetDG.yaml"
        ## github link to file
        ## ?? use mappingFile to get source info for metaKG
        bteCode: ""  
        ## github link to the code that uses this info to process response
      numericMeasures:  
      ## describes association-related numeric measures 
      - name: "DisGeNET gene-disease association score"
        responseField: "disgenet.genes_related_to_disease.score"
        measureReferences:
          websites:   ## uses staticValue sub-schema
            value: "https://www.disgenet.org/dbinfo#section31"
        range:
          minExclusive: 0
          maxInclusive: 1
        directionMeaning:
          larger: more_evidence
      - name: "DisGeNET evidence index"
        responseField: "disgenet.genes_related_to_disease.EI"
        measureReferences:
          websites:    ## uses staticValue sub-schema
            value: "https://www.disgenet.org/dbinfo#section36"
        missingValueMeaning: >-
          This measure is calculated from BeFree and PsyGeNET info. If the
          association was not found in those sources, this measure was not
          calculated
        range:
          minExclusive: 0
          maxInclusive: 1
        directionMeaning:
          larger: less_conflicting_evid
      - name: "DisGeNET disease specificity index"
        ontologyTerm: 'SIO:001351'
        responseField: "disgenet.genes_related_to_disease.DSI"
        measureReferences:
          websites:    ## uses staticValue sub-schema
            value: "https://www.disgenet.org/dbinfo#section33"   
        missingValueMeaning: >-
          This measure is calculated when a gene is associated with one or
          more diseases. If the value is missing, this gene is annotated only
          to phenotypes
        range:
          minExclusive: 0
          maxInclusive: 1
        directionMeaning:
          larger: more_specific
      - name: "DisGeNET disease pleiotropy index"
        ontologyTerm: 'SIO:001352'
        responseField: "disgenet.genes_related_to_disease.DPI"
        measureReferences:
          websites:    ## uses staticValue sub-schema
            value: "https://www.disgenet.org/dbinfo#section34"    
        missingValueMeaning: >-
          This measure is calculated when a gene is associated with one or
          more diseases in MeSH disease classes. If the value is missing, this
          gene is annotated only to phenotypes OR the associated diseases do
          not map to any MeSH classes
        range:
          minExclusive: 0
          maxInclusive: 1
        directionMeaning:
          smaller: more_specific